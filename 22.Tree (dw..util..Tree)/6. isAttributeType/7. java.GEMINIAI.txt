isAttributeType:



input:

import java.util.List;
import java.util.Map;
import java.util.LinkedHashMap;
import java.util.stream.Collectors;

public class Main {

    /**
     * Replicates the logic of dw::util::Tree::isArrayType(path).
     * Checks if the 'kind' property of the last node in the path is "ARRAY_TYPE".
     * * @param path The list representing the DataWeave AST path nodes.
     * @return true if the last node's kind is "ARRAY_TYPE", false otherwise.
     */
    @SuppressWarnings("unchecked")
    public static boolean isArrayType(List<Map<String, Object>> path) {
        if (path == null || path.isEmpty()) {
            return false;
        }
        
        // Get the last node in the path list
        Map<String, Object> lastNode = path.get(path.size() - 1);
        
        // Check its 'kind' property
        Object kind = lastNode.get("kind");
        return "ARRAY_TYPE".equals(kind);
    }

    // ---------- Pretty JSON printer (pure Java) ----------
    private static String toPrettyJson(Object obj, int indent) {
        String pad = "  ".repeat(indent);
        String next = "  ".repeat(indent + 1);

        if (obj == null) return "null";
        if (obj instanceof String) return "\"" + obj + "\"";
        if (obj instanceof Number || obj instanceof Boolean) return obj.toString();

        if (obj instanceof Map) {
            Map<?, ?> map = (Map<?, ?>) obj;
            String body = map.entrySet().stream()
                    .map(e -> next + "\"" + e.getKey() + "\": " +
                            toPrettyJson(e.getValue(), indent + 1))
                    .collect(Collectors.joining(",\n"));
            return "{\n" + body + "\n" + pad + "}";
        }

        if (obj instanceof List) {
            List<?> list = (List<?>) obj;
            String body = list.stream()
                    .map(v -> {
                        String jsonValue = toPrettyJson(v, indent + 1);
                        return jsonValue.contains("\n") ? jsonValue : next + jsonValue;
                    })
                    .collect(Collectors.joining(",\n"));
            return "[\n" + body + "\n" + pad + "]";
        }

        return obj.toString();
    }

    public static void main(String[] args) {
        
        // --- Input Structures (No unsafe Map.of usage) ---
        
        // Helper for null values when not using Map.of()
        Object nullObj = null;

        // a: Last node is ATTRIBUTE_TYPE (Expected: FALSE)
        Map<String, Object> nodeA1 = new LinkedHashMap<>();
        nodeA1.put("kind", "OBJECT_TYPE");
        nodeA1.put("selector", "user");
        nodeA1.put("namespace", nullObj);
        
        Map<String, Object> nodeA2 = new LinkedHashMap<>();
        nodeA2.put("kind", "ATTRIBUTE_TYPE");
        nodeA2.put("selector", "name");
        nodeA2.put("namespace", nullObj);
        
        List<Map<String, Object>> pathA = List.of(nodeA1, nodeA2);

        // b: Last node is ARRAY_TYPE (Expected: TRUE)
        Map<String, Object> nodeB1 = new LinkedHashMap<>();
        nodeB1.put("kind", "OBJECT_TYPE");
        nodeB1.put("selector", "user");
        nodeB1.put("namespace", nullObj);
        
        Map<String, Object> nodeB2 = new LinkedHashMap<>();
        nodeB2.put("kind", "ARRAY_TYPE");
        nodeB2.put("selector", 0);
        nodeB2.put("namespace", nullObj);
        
        List<Map<String, Object>> pathB = List.of(nodeB1, nodeB2);

        // c: Last node is ARRAY_TYPE (Expected: TRUE)
        Map<String, Object> nodeC = new LinkedHashMap<>();
        nodeC.put("kind", "ARRAY_TYPE");
        nodeC.put("selector", 0);
        nodeC.put("namespace", nullObj);
        
        List<Map<String, Object>> pathC = List.of(nodeC);

        // --- Execution ---
        Map<String, Boolean> output = new LinkedHashMap<>();
        output.put("a", isArrayType(pathA));
        output.put("b", isArrayType(pathB));
        output.put("c", isArrayType(pathC));

        // Output the map using the pure Java JSON printer
        System.out.println(toPrettyJson(output, 0));
    }
}

output:

{
  "a": true,
  "b": false,
  "c": true
}

