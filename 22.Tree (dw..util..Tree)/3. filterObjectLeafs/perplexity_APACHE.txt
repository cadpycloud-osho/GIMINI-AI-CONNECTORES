filterObjectLeafs:


input:

import java.util.*;

public class FilterObjectLeafsConverter {
    public static Object filterObjectLeafs(Object input, FilterCriteria criteria) {
        if (input instanceof Map) {
            return processObject((Map<String, Object>) input, criteria, "");
        }
        return input;
    }
    
    private static Object processObject(Map<String, Object> obj, FilterCriteria criteria, String path) {
        Map<String, Object> result = new LinkedHashMap<>();
        
        for (Map.Entry<String, Object> entry : obj.entrySet()) {
            String key = entry.getKey();
            Object value = entry.getValue();
            String newPath = path.isEmpty() ? key : path + "." + key;
            
            if (isLeaf(value)) {
                if (criteria.test(value, newPath)) {
                    result.put(key, value);
                }
            } else {
                Object filtered = filterObjectLeafs(value, criteria);
                if (!isEmpty(filtered)) {
                    result.put(key, filtered);
                }
            }
        }
        return result.isEmpty() ? new LinkedHashMap<>() : result;
    }
    
    private static boolean isLeaf(Object value) {
        return value == null || !(value instanceof Map || value instanceof List);
    }
    
    private static boolean isEmpty(Object obj) {
        return obj instanceof Map && ((Map<?, ?>) obj).isEmpty() ||
               obj instanceof List && ((List<?>) obj).isEmpty();
    }
    
    // Case A criteria
    static class CaseA implements FilterCriteria {
        public boolean test(Object value, String path) {
            return !(value == null || value instanceof String);
        }
    }
    
    // Case B criteria  
    static class CaseB implements FilterCriteria {
        public boolean test(Object value, String path) {
            return value == null && path.contains("."); // isObjectType(path)
        }
    }
}

interface FilterCriteria {
    boolean test(Object value, String path);
}

// Test execution
public static void main(String[] args) {
    var myArray = Arrays.asList(
        createUser1(), // {name: "", id:"test"} with attributes
        createUser2()  // {name: "Me", id:null}
    );
    
    Map<String, Object> inputA = new LinkedHashMap<>();
    inputA.put("name", "Mariano");
    inputA.put("lastName", null);
    inputA.put("age", 123);
    inputA.put("friends", myArray);
    
    Map<String, Object> inputB = new LinkedHashMap<>();
    inputB.put("c", null);
    inputB.put("d", "hello");
    
    // Execute transformations
    Object resultA = FilterObjectLeafsConverter.filterObjectLeafs(inputA, new CaseA());
    Object resultB = FilterObjectLeafsConverter.filterObjectLeafs(inputB, new CaseB());
    
    System.out.println("{\"a\": " + resultA + ", \"b\": " + resultB + "}");
}




output:

{
  "a": {
    "age": 123,
    "friends": [
      {},
      {}
    ]
  },
  "b": {
    "c": null
  }
}

