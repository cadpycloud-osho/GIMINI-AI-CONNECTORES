levenshteinDistance:



input:

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.Collections;
import java.util.Map;

@RestController
public class LevenshteinController {

    /**
     * Custom method to emulate DataWeave's levenshteinDistance(text1, text2) function.
     * Calculates the minimum number of edits (insertions, deletions, substitutions) 
     * required to change s1 into s2 using Dynamic Programming.
     */
    private int calculateLevenshteinDistance(String s1, String s2) {
        if (s1 == null) return s2 == null ? 0 : s2.length();
        if (s2 == null) return s1.length();

        int m = s1.length();
        int n = s2.length();
        
        // d[i][j] stores the distance between the first i characters of s1 and the first j characters of s2.
        int[][] d = new int[m + 1][n + 1];

        // Initialize the matrix borders (distance from empty string)
        for (int i = 0; i <= m; i++) {
            d[i][0] = i; // Deletions
        }
        for (int j = 0; j <= n; j++) {
            d[0][j] = j; // Insertions
        }

        // Fill the matrix
        for (int j = 1; j <= n; j++) {
            for (int i = 1; i <= m; i++) {
                // Cost is 0 if characters match, 1 otherwise
                int cost = s1.charAt(i - 1) == s2.charAt(j - 1) ? 0 : 1;
                
                // d[i][j] is the minimum of:
                // 1. Deletion from s1 (d[i-1][j] + 1)
                // 2. Insertion into s1 (d[i][j-1] + 1)
                // 3. Substitution (d[i-1][j-1] + cost)
                d[i][j] = Math.min(Math.min(d[i - 1][j] + 1, d[i][j - 1] + 1), d[i - 1][j - 1] + cost);
            }
        }

        // The result is the value at the bottom right corner
        return d[m][n];
    }

    /**
     * Endpoint equivalent to the DataWeave expression: "kitten" levenshteinDistance "sitting"
     */
    @GetMapping("/levenshtein-distance")
    public Map<String, Integer> getLevenshteinDistance() {
        String s1 = "kitten"; 
        String s2 = "sitting";
        
        int distance = calculateLevenshteinDistance(s1, s2);
        
        // Return the result in the desired JSON format
        return Collections.singletonMap("levenshteinDistance", distance);
    }
}



output:


{
  "levenshteinDistance": 3
}



