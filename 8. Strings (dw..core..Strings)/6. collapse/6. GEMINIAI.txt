collapse:


input:


import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Map;

@RestController
public class StringCollapseController {

    /**
     * Custom method to emulate DataWeave's collapse() function.
     * It splits a string into a list of substrings where each substring 
     * consists of one or more consecutive, identical characters.
     */
    private List<String> collapseString(String input) {
        if (input == null || input.isEmpty()) {
            return Collections.emptyList();
        }

        List<String> result = new ArrayList<>();
        int length = input.length();
        int i = 0;

        while (i < length) {
            char currentChar = input.charAt(i);
            int j = i;
            
            // Find the end of the sequence of identical, consecutive characters
            while (j < length && input.charAt(j) == currentChar) {
                j++;
            }
            
            // Extract the sequence (substring from i to j) and add it to the list
            result.add(input.substring(i, j));
            
            // Move the index 'i' to the start of the next character sequence
            i = j;
        }
        return result;
    }

    /**
     * Endpoint equivalent to the DataWeave expression: collapse("a  b babb a")
     */
    @GetMapping("/collapse-string")
    public Map<String, List<String>> getCollapsedString() {
        // The input string with the non-breaking space (U+00A0)
        String inputString = "a\u00A0 bbabb a"; 
        
        List<String> collapsedList = collapseString(inputString);
        
        // Return the result in the desired JSON format: { "collapse": [...] }
        return Collections.singletonMap("collapse", collapsedList);
    }
}

output:


{
  "collapse": [
    "a",
    "  ",
    "b",
    " ",
    "b",
    "a",
    "bb",
    " ",
    "a"
  ]
}










