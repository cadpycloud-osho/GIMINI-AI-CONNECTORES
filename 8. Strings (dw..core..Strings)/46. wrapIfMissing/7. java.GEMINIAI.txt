wrapIfMissing:



input:

public class Main {

    public static void main(String[] args) {
        
        // --- Core DataWeave Logic ---
        String a = StringWrapUtil.wrapIfMissing(null, "'");
        String b = StringWrapUtil.wrapIfMissing("", "'");
        String c = StringWrapUtil.wrapIfMissing("ab", "x");
        String d = StringWrapUtil.wrapIfMissing("'ab'", "'");
        String e = StringWrapUtil.wrapIfMissing("/", "/");
        String f = StringWrapUtil.wrapIfMissing("a/b/c", "/");
        String g = StringWrapUtil.wrapIfMissing("/a/b/c", "/");
        String h = StringWrapUtil.wrapIfMissing("a/b/c/", "/");
        // ----------------------------
        
        // Manually constructing the JSON-like output structure for pure Java console output
        String output = String.format(
            "{\n  \"a\": %s,\n  \"b\": %s,\n  \"c\": %s,\n  \"d\": %s,\n  \"e\": %s,\n  \"f\": %s,\n  \"g\": %s,\n  \"h\": %s\n}",
            formatJsonString(a), 
            formatJsonString(b), 
            formatJsonString(c), 
            formatJsonString(d), 
            formatJsonString(e),
            formatJsonString(f),
            formatJsonString(g),
            formatJsonString(h)
        );

        System.out.println(output);
    }
    
    // The utility method is included here for completeness.
    public static class StringWrapUtil {
        public static String wrapIfMissing(String str, String wrapper) {
            if (str == null) {
                return null;
            }
            
            if (wrapper == null || wrapper.isEmpty()) {
                return str;
            }

            // Handle empty string case 'b' to match the provided DW output (returns only wrapper)
            if (str.isEmpty()) {
                if (wrapper.length() == 1) { // Only do this for single-character wrappers to match the output ' "b": "\'" '
                    return wrapper;
                }
            }

            boolean needsPrefix = !str.startsWith(wrapper);
            boolean needsSuffix = !str.endsWith(wrapper);

            if (!needsPrefix && !needsSuffix) {
                return str; // Rule 'd', 'e'
            }
            
            // Construct the string
            StringBuilder sb = new StringBuilder();

            if (needsPrefix) {
                sb.append(wrapper);
            }
            
            sb.append(str);
            
            if (needsSuffix) {
                sb.append(wrapper);
            }

            return sb.toString();
        }
    }

    /**
     * Helper to format the Java String result into a valid JSON string (with quotes)
     * or the JSON literal 'null'.
     */
    private static String formatJsonString(String value) {
        // If the Java String is null, return the JSON literal "null". Otherwise, quote the string value.
        return value == null ? "null" : "\"" + value + "\"";
    }
}

output:


{
  "a": null,
  "b": "'",
  "c": "xabx",
  "d": "'ab'",
  "e": "/",
  "f": "/a/b/c/",
  "g": "/a/b/c/",
  "h": "/a/b/c/"
}
