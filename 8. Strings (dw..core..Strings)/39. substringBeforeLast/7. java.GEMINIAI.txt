substringBeforeLast:


input:

public class Main {

    public static void main(String[] args) {
        
        // --- Core DataWeave Logic ---
        String a = SubstringUtil.substringBeforeLast(null, "'");
        String b = SubstringUtil.substringBeforeLast("", "-");
        String c = SubstringUtil.substringBeforeLast("abc", "b");
        String d = SubstringUtil.substringBeforeLast("abcba", "b");
        String e = SubstringUtil.substringBeforeLast("abc", "d");
        String f = SubstringUtil.substringBeforeLast("abc", "");
        // ----------------------------
        
        // Manually constructing the JSON-like output structure for pure Java console output
        String output = String.format(
            "{\n  \"a\": %s,\n  \"b\": %s,\n  \"c\": %s,\n  \"d\": %s,\n  \"e\": %s,\n  \"f\": %s\n}",
            formatJsonString(a), 
            formatJsonString(b), 
            formatJsonString(c), 
            formatJsonString(d), 
            formatJsonString(e),
            formatJsonString(f)
        );

        System.out.println(output);
    }
    
    // The utility method is included here for completeness.
    public static class SubstringUtil {
        public static String substringBeforeLast(String str, String separator) {
            if (str == null) {
                return null; // DW Rule 'a'
            }
            if (separator == null || separator.isEmpty()) {
                // DW Rule 'f': Returns string minus the last character.
                return str.substring(0, Math.max(0, str.length() - 1));
            }

            int separatorIndex = str.lastIndexOf(separator);

            if (separatorIndex == -1) {
                return ""; // DW Rule 'b', 'e'
            }

            // DW Rule 'c', 'd'
            return str.substring(0, separatorIndex);
        }
    }

    /**
     * Helper to format the Java String result into a valid JSON string (with quotes)
     * or the JSON literal 'null'.
     */
    private static String formatJsonString(String value) {
        // If the Java String is null, return the JSON literal "null". Otherwise, quote the string value.
        return value == null ? "null" : "\"" + value + "\"";
    }
}

output:

{
  "a": null,
  "b": "",
  "c": "a",
  "d": "abc",
  "e": "",
  "f": "ab"
}

