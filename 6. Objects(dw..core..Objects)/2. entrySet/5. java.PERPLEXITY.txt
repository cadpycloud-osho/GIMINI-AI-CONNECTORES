entrySet:


input:

import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.DocumentBuilder;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.NodeList;
import org.w3c.dom.NamedNodeMap;
import java.util.*;

public class Main {
    public static void main(String[] args) throws Exception {
        // DataWeave equivalent: read('<xml attr="x"><a>true</a><b>1</b></xml>', 'application/xml')
        String xmlContent = "<xml attr=\"x\"><a>true</a><b>1</b></xml>";
        Document myVar = parseXml(xmlContent);
        
        // DataWeave equivalent: entrySet(myVar)
        List<Map<String, Object>> entrySet = entrySet(myVar);
        
        // Output as JSON structure matching DataWeave
        System.out.println("{");
        System.out.println("  \"entrySet\": " + listToJson(entrySet));
        System.out.println("}");
    }
    
    // Parse XML string to Document (read(..., 'application/xml'))
    public static Document parseXml(String xml) throws Exception {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = factory.newDocumentBuilder();
        return builder.parse(new java.io.ByteArrayInputStream(xml.getBytes()));
    }
    
    // DataWeave "entrySet(xmlObject)" equivalent
    public static List<Map<String, Object>> entrySet(Document doc) {
        List<Map<String, Object>> result = new ArrayList<>();
        
        Element root = doc.getDocumentElement();
        Map<String, Object> entry = new LinkedHashMap<>();
        
        // Extract attributes
        NamedNodeMap attrs = root.getAttributes();
        Map<String, String> attributes = new LinkedHashMap<>();
        for (int i = 0; i < attrs.getLength(); i++) {
            attributes.put(attrs.item(i).getNodeName(), attrs.item(i).getNodeValue());
        }
        
        // Extract child elements as object
        Map<String, String> children = new LinkedHashMap<>();
        NodeList childNodes = root.getChildNodes();
        for (int i = 0; i < childNodes.getLength(); i++) {
            if (childNodes.item(i) instanceof Element) {
                Element child = (Element) childNodes.item(i);
                children.put(child.getTagName(), child.getTextContent());
            }
        }
        
        entry.put("key", root.getTagName());      // "xml"
        entry.put("value", children);             // {"a": "true", "b": "1"}
        entry.put("attributes", attributes);      // {"attr": "x"}
        
        result.add(entry);
        return result;
    }
    
    // Utility to format as JSON
    private static String listToJson(List<Map<String, Object>> list) {
        StringBuilder sb = new StringBuilder("[");
        for (int i = 0; i < list.size(); i++) {
            if (i > 0) sb.append(",\n    ");
            sb.append(mapToJson(list.get(i), 4));
        }
        sb.append("\n  ]");
        return sb.toString();
    }
    
    private static String mapToJson(Map<String, Object> map, int indent) {
        StringBuilder sb = new StringBuilder("{\n");
        String spaces = " ".repeat(indent + 2);
        map.forEach((k, v) -> {
            sb.append(spaces).append("\"").append(k).append("\": ");
            if (v instanceof Map) {
                sb.append(mapToJson((Map<String, Object>) v, indent + 2));
            } else {
                sb.append("\"").append(v).append("\"");
            }
            sb.append(",\n");
        });
        if (!map.isEmpty()) sb.setLength(sb.length() - 2); // Remove last ","
        sb.append("\n").append(" ".repeat(indent)).append("}");
        return sb.toString();
    }
}



output:

{
  "entrySet": [
    {
      "key": "xml",
      "value": {
        "a": "true",
        "b": "1"
      },
      "attributes": {
        "attr": "x"
      }
    }
  ]
}


