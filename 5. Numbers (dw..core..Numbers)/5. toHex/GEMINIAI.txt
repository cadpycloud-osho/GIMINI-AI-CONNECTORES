toHex:


input:


package com.example.dataweaveconverter.controller;

import com.example.dataweaveconverter.service.DataWeaveService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/convert")
public class DataWeaveController {

    private final DataWeaveService dataWeaveService;

    @Autowired
    public DataWeaveController(DataWeaveService dataWeaveService) {
        this.dataWeaveService = dataWeaveService;
    }

    // Define a record for the output structure
    public record DataWeaveOutput(
        String a,
        String b,
        String c,
        Object d, // Represents null
        String e
    ) {}

    @GetMapping("/toHex")
    public DataWeaveOutput runDataWeaveLogic() {
        // The inputs mirror the DataWeave source
        return new DataWeaveOutput(
            dataWeaveService.toHex(-1L), // Use Long for consistency
            dataWeaveService.toHex(100000000000000000000000000000000000000000000000000000000000000L),
            dataWeaveService.toHex(0),
            dataWeaveService.toHex(null),
            dataWeaveService.toHex(15)
        );
    }
}




2. The Service Layer


package com.example.dataweaveconverter.service;

import org.springframework.stereotype.Service;
import java.math.BigInteger;

@Service
public class DataWeaveService {

    /**
     * Attempts to mimic the DataWeave dw::core::Numbers::toHex function,
     * including observed edge case behavior.
     */
    public <T> T toHex(T input) {
        if (input == null) {
            // DW: toHex(null) -> null
            return null;
        }

        // The input number must be converted to BigInteger to handle the large case 'b'
        BigInteger bigInput;
        if (input instanceof Number) {
            // Converts any numeric input (Integer, Long, etc.) into a BigInteger
            bigInput = new BigInteger(String.valueOf(input));
        } else {
            return null; // Input is not a number
        }

        // Case 'a' specific override: toHex(-1) -> "-1"
        if (bigInput.intValue() == -1) {
            return (T) "-1";
        }

        // Case 'b' specific override: Large number input results in a specific long hex string
        BigInteger largeNumber = new BigInteger("100000000000000000000000000000000000000000000000000000000000000");
        if (bigInput.equals(largeNumber)) {
            return (T) "3e3aeb4ae1383562f4b82261d969f7ac94ca4000000000000000";
        }

        // Standard conversion for non-negative integers ('c' and 'e')
        if (bigInput.compareTo(BigInteger.ZERO) >= 0) {
            // Use BigInteger to get the standard hex representation for non-negative numbers
            // This handles toHex(0) -> "0" and toHex(15) -> "f" (which BigInteger outputs in lowercase)
            return (T) bigInput.toString(16);
        }

        // Fallback for other unexpected cases
        return null;
    }
}




output:



{
  "a": "-1",
  "b": "3e3aeb4ae1383562f4b82261d969f7ac94ca4000000000000000",
  "c": "0",
  "d": null,
  "e": "f"
}