acos:



input:

import java.util.LinkedHashMap;
import java.util.Map;
import java.util.List;
import java.util.stream.Collectors;

public class Main {

    // Removed ObjectMapper dependency.

    /**
     * Helper function to replicate DataWeave's acos behavior (returning null for out-of-range input)
     * @param x The value to calculate the arc cosine for.
     * @return The arc cosine value in radians, or null if x is outside [-1, 1].
     */
    private static Object acos(double x) {
        // DataWeave's acos returns null if x is outside the range [-1, 1].
        if (x < -1.0 || x > 1.0) {
            return null;
        }
        // Math.acos returns the arc cosine of a value in the range [0.0, pi].
        return Math.acos(x);
    }

    // ---------- Pretty JSON printer (pure Java) ----------
    @SuppressWarnings("unchecked")
    private static String toPrettyJson(Object obj, int indent) {
        String pad = "  ".repeat(indent);
        String next = "  ".repeat(indent + 1);

        if (obj == null) return "null";
        if (obj instanceof String) return "\"" + obj + "\"";
        
        // Use String.valueOf for Numbers and Booleans to preserve decimal precision if needed
        if (obj instanceof Number || obj instanceof Boolean) return String.valueOf(obj);

        if (obj instanceof Map) {
            Map<?, ?> map = (Map<?, ?>) obj;
            String body = map.entrySet().stream()
                    .map(e -> next + "\"" + e.getKey() + "\": " +
                            toPrettyJson(e.getValue(), indent + 1))
                    .collect(Collectors.joining(",\n"));
            return "{\n" + body + "\n" + pad + "}";
        }

        if (obj instanceof List) {
            List<?> list = (List<?>) obj;
            String body = list.stream()
                    .map(v -> toPrettyJson(v, indent + 1))
                    .map(s -> s.contains("\n") ? s : next + s)
                    .collect(Collectors.joining(",\n"));
            return "[\n" + body + "\n" + pad + "]";
        }

        return String.valueOf(obj);
    }


    public static void main(String[] args) {
        System.out.println("--- Pure Java Output Simulation ---");

        // Use LinkedHashMap to maintain insertion order, matching DataWeave's predictable output structure.
        Map<String, Object> output = new LinkedHashMap<>();

        // Simulating the DataWeave calls:
        output.put("acos0", acos(0));
        output.put("acos13", acos(0.13));
        output.put("acos-1", acos(-1));
        output.put("acos1", acos(1));
        output.put("acos1.1", acos(1.1));

        // Output the map using the pure Java JSON printer
        System.out.println(toPrettyJson(output, 0));
    }
}


output:

{
  "acos0": 1.5707963267948966,
  "acos13": 1.440427347091751,
  "acos-1": 3.141592653589793,
  "acos1": 0.0,
  "acos1.1": null
}


