try:


input:

import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.Map;
import java.util.Random;

@RestController
public class TryRandomController {

    private final Random random = new Random();

    @GetMapping(value = "/try-random", produces = MediaType.APPLICATION_JSON_VALUE)
    public Map<String, Object> tryRandomNumber() {
        try {
            // Matches: try(() -> randomNumber())
            Object result = randomNumber();
            return Map.of("success", true, "result", result);
        } catch (RuntimeException e) {
            // Matches DataWeave error structure on fail
            return Map.of(
                "success", false,
                "error", Map.of(
                    "kind", "UserException",
                    "message", e.getMessage(),
                    "location", "Unknown location",
                    "stack", List.of(
                        "fail (anonymous:0:0)",
                        "myFunction (anonymous:1:114)",
                        "main (anonymous:1:179)"
                    )
                )
            );
        }
    }

    // Matches: fun randomNumber() = if(random() > 0.5) fail("This function is failing") else "OK"
    private Object randomNumber() {
        if (random.nextDouble() > 0.5) {
            throw new RuntimeException("This function is failing");
        }
        return "OK";
    }
}


output:


SUCCESS (50% chance - random() <= 0.5):
Spring Boot (GET /try-random) and Pure Java:

json
{
  "success": true,
  "result": "OK"
}
FAILURE (50% chance - random() > 0.5):
Spring Boot (GET /try-random) and Pure Java:

json
{
  "success": false,
  "error": {
    "kind": "UserException",
    "message": "This function is failing",
    "location": "Unknown location",
    "stack": [
      "fail (anonymous:0:0)",
      "myFunction (anonymous:1:114)",
      "main (anonymous:1:179)"
    ]
  }
}

