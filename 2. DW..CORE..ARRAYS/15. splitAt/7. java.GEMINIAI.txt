splitAt:




input:

import java.util.Arrays;
import java.util.List;

public class Main {
    
    // Generic class to hold the result of the split
    static class SplitResult<T> {
        List<T> l; // Left part (0 up to split index - 1)
        List<T> r; // Right part (split index onwards)

        // Constructor name must match the class name
        public SplitResult(List<T> l, List<T> r) {
            this.l = l;
            this.r = r;
        }
        
        // Custom toString to match the DataWeave output structure
        @Override
        public String toString() {
            // Replaces list brackets [] with parentheses () for data items to match the output style 
            // (assuming the output [Mariano] is simplified representation, standard list output is used).
            return "{\n  \"l\": " + l.toString() + ",\n  \"r\": " + r.toString() + "\n}";
        }
    }

    /**
     * DataWeave logic equivalent to: input splitAt 1
     */
    public static <T> SplitResult<T> splitArray(List<T> list, int index) {
        if (index < 0 || index > list.size()) {
            throw new IndexOutOfBoundsException("Split index is out of bounds.");
        }
        
        // Left part: from 0 (inclusive) up to 'index' (exclusive)
        List<T> left = list.subList(0, index);
        
        // Right part: from 'index' (inclusive) up to the end (size)
        List<T> right = list.subList(index, list.size());
        
        return new SplitResult<>(left, right);
    }


    public static void main(String[] args) {
        // Source data array
        List<String> list = Arrays.asList("Mariano", "Leandro", "Julian");
        
        // DataWeave Logic: splitAt 1 (splits before index 1)
        int splitIndex = 1;
        
        SplitResult<String> result = splitArray(list, splitIndex);

        // Print the final output structure
        System.out.println(result);
    }
}

output:

{
  "l": [Mariano],
  "r": [Leandro, Julian]
}



























1. Java Code (Using the Built-in List.subList() Method)
The List.subList() method is ideal here, as it naturally implements the inclusive start and exclusive end indexing needed for the split.

Java

import java.util.Arrays;
import java.util.List;

public class DataWeaveSplitAtBuiltIn {

    public static <T> SplitResult<T> splitAt(List<T> list, int splitIndex) {
        // DataWeave behavior: 
        // 1. Left part ('l'): from index 0 up to splitIndex (exclusive)
        List<T> left = list.subList(0, splitIndex);
        
        // 2. Right part ('r'): from splitIndex up to the end (inclusive)
        List<T> right = list.subList(splitIndex, list.size());
        
        return new SplitResult<>(left, right);
    }

    public static void main(String[] args) {
        // Source data array (DataWeave 'users' variable)
        List<String> users = Arrays.asList("Mariano", "Leandro", "Julian");
        
        // DataWeave Logic: users splitAt 1
        SplitResult<String> result = splitAt(users, 1);

        // Output the result
        System.out.println("Output structure:");
        System.out.println(result); 
    }
}
2. Java Code (Using an Imperative Loop)
This approach manually iterates and distributes the elements to the two new lists based on the split index.

Java

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class DataWeaveSplitAtImperative {

    public static <T> SplitResult<T> splitAt(List<T> list, int splitIndex) {
        List<T> left = new ArrayList<>();
        List<T> right = new ArrayList<>();
        
        // Iterate through all elements
        for (int i = 0; i < list.size(); i++) {
            if (i < splitIndex) {
                // Element belongs to the left part
                left.add(list.get(i));
            } else {
                // Element belongs to the right part (starting at splitIndex)
                right.add(list.get(i));
            }
        }
        
        return new SplitResult<>(left, right);
    }

    public static void main(String[] args) {
        // Source data array (DataWeave 'users' variable)
        List<String> users = Arrays.asList("Mariano", "Leandro", "Julian");
        
        // DataWeave Logic: users splitAt 1
        SplitResult<String> result = splitAt(users, 1);

        // Output the result
        System.out.println("Output structure:");
        System.out.println(result);
    }
}
âœ… Output for Both Java Codes
The output for both the Java built-in method and the Java imperative loop is identical and correctly matches the expected DataWeave output:

JSON

Output structure:
{
  "l": [Mariano],
  "r": [Leandro, Julian]
}