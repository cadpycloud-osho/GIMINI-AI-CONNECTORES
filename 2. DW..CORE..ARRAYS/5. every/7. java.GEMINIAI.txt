every:


input:

import java.util.Arrays;
import java.util.List;
import java.util.function.Predicate;

public class Main {

    /**
     * Mimics DataWeave's 'every' function using Java Streams.
     * Checks if all elements in the list match the predicate (short-circuiting).
     */
    public static <T> boolean arrayEvery(List<T> list, Predicate<T> predicate) {
        // allMatch() is the functional equivalent and includes short-circuiting.
        return list.stream().allMatch(predicate);
    }
    
    // Predicate used in DataWeave example to demonstrate short-circuiting 
    // (We simulate the 'log' side effect by printing)
    private static Predicate<Integer> shortCircuitPredicate = n -> {
        // This is a direct simulation of: 
        // (log('should stop at 2 ==', $) mod 2) == 1)
        
        // This log is executed for each element until the condition fails.
        // It's meant to show *where* it stops.
        // System.out.println("Checking element: " + n); 
        
        return (n % 2) == 1; // Check if the number is odd
    };


    public static void main(String[] args) {
        // DataWeave variable
        List<Integer> arr0 = Arrays.asList(); // empty array

        // --- "ok" (Expected True) Cases ---
        List<Integer> list_ok1 = Arrays.asList(1, 1, 1);
        List<Integer> list_ok2 = Arrays.asList(1);

        boolean ok1 = arrayEvery(list_ok1, n -> n == 1);
        boolean ok2 = arrayEvery(list_ok2, n -> n == 1);
        
        List<Boolean> results_ok = Arrays.asList(ok1, ok2);

        // --- "err" (Expected False) Cases ---
        List<Integer> list_err1 = Arrays.asList(1, 2, 3); // Fails at 2
        List<Integer> list_err2 = Arrays.asList(1, 1, 0); // Fails at 0
        List<Integer> list_err3 = Arrays.asList(0, 1, 1, 0); // Fails at 0
        List<Integer> list_err4 = Arrays.asList(1, 2, 3); // Fails at 2
        
        // Note: For empty array (arr0), every condition is vacuously true in DataWeave.
        
        boolean err1 = arrayEvery(list_err1, shortCircuitPredicate);
        boolean err2 = arrayEvery(list_err2, n -> n == 1);
        boolean err3 = arrayEvery(list_err3, n -> n == 1);
        boolean err4 = arrayEvery(list_err4, n -> n == 1);
        boolean err5 = arrayEvery(arr0, n -> true); // Empty array check

        List<Boolean> results_err = Arrays.asList(err1, err2, err3, err4, err5);

        // Print the final combined JSON-like output structure
        System.out.println("Output structure:");
        System.out.println("{");
        System.out.println("  \"results\": [");
        System.out.println("    { \"ok\": " + results_ok + " },");
        System.out.println("    { \"err\": " + results_err + " }");
        System.out.println("  ]");
        System.out.println("}");
    }
}




output:


Output structure:
{
  "results": [
    { "ok": [true, true] },
    { "err": [false, false, false, false, true] } // **Note**: The last element is 'true' based on correct DW logic (empty array every true)
  ]
}






Java Code (Using an Imperative Loop)
This approach uses a standard for loop, which naturally implements the short-circuiting logic with a return false statement.

Java

import java.util.Arrays;
import java.util.List;
import java.util.function.Predicate;

public class Main {

    /**
     * Mimics DataWeave's 'every' function using an imperative loop.
     * Checks if all elements in the list match the predicate (short-circuiting).
     */
    public static <T> boolean arrayEvery(List<T> list, Predicate<T> predicate) {
        // Handle the empty list case (vacuously true)
        if (list.isEmpty()) {
            return true;
        }
        
        // Loop and check condition for each element
        for (T item : list) {
            if (!predicate.test(item)) {
                return false; // Short-circuit: stop immediately if one fails
            }
        }
        return true; // If the loop completes, all elements passed
    }

    // Predicate used in DataWeave example (checking for odd numbers)
    private static Predicate<Integer> oddPredicate = n -> (n % 2) == 1;

    public static void main(String[] args) {
        // DataWeave variable
        List<Integer> arr0 = Arrays.asList(); // empty array

        // --- "ok" (Expected True) Cases ---
        boolean ok1 = arrayEvery(Arrays.asList(1, 1, 1), n -> n == 1);
        boolean ok2 = arrayEvery(Arrays.asList(1), n -> n == 1);
        List<Boolean> results_ok = Arrays.asList(ok1, ok2);

        // --- "err" (Expected False) Cases ---
        boolean err1 = arrayEvery(Arrays.asList(1, 2, 3), oddPredicate);
        boolean err2 = arrayEvery(Arrays.asList(1, 1, 0), n -> n == 1);
        boolean err3 = arrayEvery(Arrays.asList(0, 1, 1, 0), n -> n == 1);
        boolean err4 = arrayEvery(Arrays.asList(1, 2, 3), n -> n == 1);
        boolean err5 = arrayEvery(arr0, n -> true); // Empty array check (should be true)
        
        // Wait, the DataWeave output says false for the empty array: "err": [..., false]
        // DataWeave arr0 every true results in **true** (vacuously true for empty array).
        // Let's re-check the DataWeave output:
        // [1, 2, 3] every ((log...) mod 2) == 1) -> false
        // [1, 1, 0] every ($ == 1) -> false
        // [0, 1, 1, 0] every (log(...) == 1) -> false
        // [1, 2, 3] every ($ == 1) -> false
        // arr0 every true -> **true** (The DW output provided must have a typo on the last false, it should be true).
        // Based on DataWeave documentation, arr0 every true is TRUE.
        // Assuming the Java code must match the *logic* (vacuously true):
        
        List<Boolean> results_err = Arrays.asList(err1, err2, err3, err4, err5);

        // Print the final combined JSON-like output structure
        System.out.println("Output structure:");
        System.out.println("{");
        System.out.println("  \"results\": [");
        System.out.println("    { \"ok\": " + results_ok + " },");
        System.out.println("    { \"err\": " + results_err + " }");
        System.out.println("  ]");
        System.out.println("}");
    }
}

Output structure:
{
  "results": [
    { "ok": [true, true] },
    { "err": [false, false, false, false, true] } // **Note**: The last element is 'true' based on correct DW logic (empty array every true)
  ]
}
