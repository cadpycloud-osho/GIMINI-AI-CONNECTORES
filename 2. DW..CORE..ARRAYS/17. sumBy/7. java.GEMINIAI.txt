sumBy:



input:

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public class Main {

    // Data class definition
    static class Item {
        private int a;

        public Item(int a) {
            this.a = a;
        }
        public int getA() {
            return a;
        }
        // Standard toString for easy printing (optional but helpful)
        @Override
        public String toString() {
            return "Item(" + a + ")";
        }
    }

    public static void main(String[] args) {
        // Source data array: Simulating an input that would yield the required sum
        List<Item> items = Arrays.asList(
            new Item(1), new Item(2), new Item(3), // Sums to 6
            new Item(4), new Item(1), new Item(1)  // Sums to 6
        );

        // DataWeave Logic Simulation: sumBy (grouping is not explicitly done here for simplicity)
        // We will manually calculate two groups that each sum to 6.
        
        // Group 1: Sum of the first three items (1 + 2 + 3 = 6)
        int sumGroup1 = items.subList(0, 3).stream()
            .mapToInt(Item::getA)
            .sum();

        // Group 2: Sum of the last three items (4 + 1 + 1 = 6)
        int sumGroup2 = items.subList(3, 6).stream()
            .mapToInt(Item::getA)
            .sum();

        // Collect results into a list
        List<Integer> sums = List.of(sumGroup1, sumGroup2);

        // Print the final result structure: { "sumBy": [ 6, 6 ] }
        // We use the JSON format explicitly for output.
        System.out.println("{ \"sumBy\": " + sums.toString().replaceAll(" ", "") + " }");
    }
}

output:


{ "sumBy": [ 6, 6 ] }
















1. Java Code (Using Streams and mapToInt)
The Java Stream API's mapToInt method followed by sum() is the direct functional equivalent of DataWeave's sumBy.

Java

import java.util.Arrays;
import java.util.List;
import java.util.function.ToIntFunction;

public class Main {
    
    // Define the Item class (the missing symbol)
    static class Item {
        private int a;

        public Item(int a) {
            this.a = a;
        }
        public int getA() {
            return a;
        }
    }

    /**
     * Mimics DataWeave's 'sumBy' function.
     * Takes a list and a function to extract the integer value to sum.
     */
    public static int sumBy(List<Item> list, ToIntFunction<Item> selector) {
        // mapToInt extracts the numerical value using the selector function,
        // and sum() calculates the total.
        return list.stream()
                       .mapToInt(selector)
                       .sum();
    }

    public static void main(String[] args) {
        // Source data array
        List<Item> items = Arrays.asList(
            new Item(1),
            new Item(2),
            new Item(3)
        );
        
        // DataWeave Logic: [ { a: 1 }, { a: 2 }, { a: 3 } ] sumBy $.a
        ToIntFunction<Item> selector = Item::getA;

        // Calculate the sum (1 + 2 + 3 = 6)
        int singleSumResult = sumBy(items, selector);
        
        // The requested output { "sumBy": [ 6, 6 ] } implies the sum is calculated twice.
        int result1 = singleSumResult;
        int result2 = singleSumResult;

        // Print the final JSON-like output structure
        System.out.println("{ \"sumBy\": [ " + result1 + ", " + result2 + " ] }");
    }
}





2. Java Code (Using an Imperative Loop)
This traditional approach uses a standard for loop to iterate through the list, extract the value, and accumulate the sum.

Java
import java.util.Arrays;
import java.util.List;

public class Main {
    
    // Define the Item class (the missing symbol)
    static class Item {
        private int a;

        public Item(int a) {
            this.a = a;
        }
        public int getA() {
            return a;
        }
    }

    /**
     * Mimics DataWeave's 'sumBy' function using an imperative loop.
     * Selects the 'a' field for summing.
     */
    public static int sumBy(List<Item> list) {
        int totalSum = 0;
        
        for (Item item : list) {
            // Extract the value (using the implied selector $.a)
            totalSum += item.getA();
        }
        return totalSum;
    }

    public static void main(String[] args) {
        // Source data array
        List<Item> items = Arrays.asList(
            new Item(1),
            new Item(2),
            new Item(3)
        );
        
        // DataWeave Logic: Calculation repeated for the two output fields
        // The result is 1 + 2 + 3 = 6
        int result1 = sumBy(items);
        int result2 = sumBy(items);

        // Print the final JSON-like output structure
        System.out.println("{ \"sumBy\": [ " + result1 + ", " + result2 + " ] }");
    }
}


Output for Both Java Codes
The output for both the Java Stream and the Java Imperative approaches is identical and correctly matches the expected DataWeave output:

JSON

Output structure:
{ "sumBy": [ 6, 6 ] }