join:


input:

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.*;

@SpringBootApplication
public class JoinDemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(JoinDemoApplication.class, args);
    }
}

class User {
    public String id;
    public String name;
    public User(String id, String name) { this.id = id; this.name = name; }
}

class Product {
    public String ownerId;
    public String name;
    public Product(String ownerId, String name) { this.ownerId = ownerId; this.name = name; }
}

@RestController
class JoinController {
    
    private List<Map<String, Object>> join(List<User> left, List<Product> right,
                                         java.util.function.Function<User, String> leftKey,
                                         java.util.function.Function<Product, String> rightKey) {
        List<Map<String, Object>> result = new ArrayList<>();
        
        for (User user : left) {
            String userId = leftKey.apply(user);
            for (Product product : right) {
                if (userId.equals(rightKey.apply(product))) {
                    Map<String, Object> pair = new HashMap<>();
                    pair.put("l", user);
                    pair.put("r", product);
                    result.add(pair);
                }
            }
        }
        return result;
    }
    
    @GetMapping("/join")
    public Map<String, List<Map<String, Object>>> joinExample() {
        List<User> users = Arrays.asList(
            new User("1", "Mariano"),
            new User("2", "Leandro"),
            new User("3", "Julian"),
            new User("5", "Julian")
        );
        
        List<Product> products = Arrays.asList(
            new Product("1", "DataWeave"),
            new Product("1", "BAT"),
            new Product("3", "DataSense"),
            new Product("4", "SmartConnectors")
        );
        
        List<Map<String, Object>> result = join(users, products,
            user -> user.id,
            product -> product.ownerId
        );
        
        Map<String, List<Map<String, Object>>> response = new HashMap<>();
        response.put("joinResult", result);
        return response;
    }
}


output:


{
  "joinResult": [
    {
      "l": {
        "id": "1",
        "name": "Mariano"
      },
      "r": {
        "ownerId": "1",
        "name": "DataWeave"
      }
    },
    {
      "l": {
        "id": "1",
        "name": "Mariano"
      },
      "r": {
        "ownerId": "1",
        "name": "BAT"
      }
    },
    {
      "l": {
        "id": "3",
        "name": "Julian"
      },
      "r": {
        "ownerId": "3",
        "name": "DataSense"
      }
    }
  ]
}
