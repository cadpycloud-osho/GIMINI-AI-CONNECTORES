pluck:


example 1:


input:

package com.example.pluck;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.atomic.AtomicInteger;

@RestController
public class PluckExample1Controller {

    @GetMapping("/pluck-transform")
    public List<Map<String, Map<String, String>>> pluckAndTransform() {
        // The input map, using LinkedHashMap to ensure consistent order for indexing
        Map<String, String> inputMap = new LinkedHashMap<>();
        inputMap.put("a", "b");
        inputMap.put("c", "d");
        
        // Counter for the index (equivalent to $$$)
        AtomicInteger index = new AtomicInteger(0);
        
        List<Map<String, Map<String, String>>> result = new ArrayList<>();

        // Java Equivalent: Stream over the Map entries
        inputMap.entrySet().forEach(entry -> {
            String key = entry.getKey();   // DW: key
            String value = entry.getValue(); // DW: value
            int i = index.getAndIncrement(); // DW: index
            
            // Reconstruct the nested object: { (index) : { (value):key} }
            // Example: { "0": { "b": "a" } }
            
            // Inner map: { (value): key } -> { "b": "a" }
            Map<String, String> innerMap = Map.of(value, key);
            
            // Outer map: { (index): innerMap } -> { "0": { "b": "a" } }
            Map<String, Map<String, String>> outerMap = Map.of(String.valueOf(i), innerMap);
            
            result.add(outerMap);
        });

        return result;
    }
}

output:

[
  {
    "0": {
      "b": "a"
    }
  },
  {
    "1": {
      "d": "c"
    }
  }
]
----------------------------------------------------------------


example 2:


input:

package com.example.pluck;

import com.fasterxml.jackson.dataformat.xml.XmlMapper;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

@RestController
public class PluckExample2Controller {

    private final XmlMapper xmlMapper = new XmlMapper();

    @GetMapping("/pluck-xml")
    public Map<String, Object> pluckXml() throws Exception {
        
        String xml = "<prices><basic>9.99</basic><premium>53.00</premium><vip>398.99</vip></prices>";
        
        // 1. XML Parsing (Equivalent to read(..., "application/xml"))
        // Parses XML into a nested Map structure: { "prices": { "basic": "9.99", ... } }
        Map<String, Object> xmlRoot = xmlMapper.readValue(xml, Map.class);
        
        // 2. Access the target element (Equivalent to readXml.prices)
        // This will be a Map of prices: { "basic": "9.99", "premium": "53.00", "vip": "398.99" }
        @SuppressWarnings("unchecked")
        Map<String, String> pricesMap = (Map<String, String>) xmlRoot.get("prices");

        // 3. Pluck Logic
        List<String> keys = new ArrayList<>();
        List<Double> values = new ArrayList<>();
        List<Integer> indices = new ArrayList<>();
        
        int index = 0;
        for (Map.Entry<String, String> entry : pricesMap.entrySet()) {
            // DW: pluck($$) -> key
            keys.add(entry.getKey()); 
            
            // DW: pluck($) as Number -> value converted to Double
            values.add(Double.parseDouble(entry.getValue())); 
            
            // DW: pluck($$$) -> index
            indices.add(index++);
        }
        
        // 4. Construct the final output structure
        Map<String, Object> resultInner = Map.of(
            "keys", keys,
            "values", values,
            "indices", indices
        );
        
        return Map.of("result", resultInner);
    }
}

output:


{
  "result": {
    "keys": [
      "basic",
      "premium",
      "vip"
    ],
    "values": [
      9.99,
      53.0,
      398.99
    ],
    "indices": [
      0,
      1,
      2
    ]
  }
}
