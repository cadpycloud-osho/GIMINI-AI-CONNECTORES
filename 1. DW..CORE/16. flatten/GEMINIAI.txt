FLATTEN:

INPUT:

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public class FlattenExample1 {

    public static List<Integer> flattenListOfNumbers(List<List<Integer>> listOfLists) {
        // DataWeave: flatten(arrayOfArrays)
        return listOfLists.stream()
                // flatMap takes each inner list and creates a stream from it, 
                // then merges all these streams into a single list.
                .flatMap(List::stream) 
                .collect(Collectors.toList());
    }

    public static void main(String[] args) {
        List<Integer> array1 = Arrays.asList(1, 2, 3);
        List<Integer> array2 = Arrays.asList(4, 5, 6);
        List<Integer> array3 = Arrays.asList(7, 8, 9);
        List<List<Integer>> arrayOfArrays = Arrays.asList(array1, array2, array3);

        List<Integer> output = flattenListOfNumbers(arrayOfArrays);
        
        System.out.println("Input List: " + arrayOfArrays);
        System.out.println("Output: " + output);
    }
}

OUTPUT:

[1, 2, 3, 4, 5, 6, 7, 8, 9]

________________________________________________________________________


INPUT:

import java.util.Arrays;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

// Helper class for the inner object (DataWeave: { name : "Shoki", id : 5678 })
class UserDetail {
    String name;
    int id;
    
    public UserDetail(String name, int id) {
        this.name = name;
        this.id = id;
    }

    // toString for console output
    @Override
    public String toString() {
        return "{\"name\":\"" + name + "\",\"id\":" + id + "}";
    }
}

// Helper class for the structure containing the list of lists
class UserGroup {
    String group;
    List<UserDetail> myarray; // This is the inner list

    public UserGroup(String group, List<UserDetail> myarray) {
        this.group = group;
        this.myarray = myarray;
    }
    
    // Getter for myarray to simplify access
    public List<UserDetail> getMyarray() {
        return myarray;
    }
}

public class FlattenExample2 {

    public static List<UserDetail> flattenNestedList(List<UserGroup> userList) {
        // DataWeave: flatten(myData.user.myarray)
        
        // 1. Stream the outer list (List<UserGroup>)
        // 2. Map each UserGroup object to its 'myarray' list (List<UserDetail>)
        // 3. flatMap flattens the resulting List<List<UserDetail>> into List<UserDetail>
        return userList.stream()
                .map(UserGroup::getMyarray) // Accesses the nested array
                .flatMap(List::stream)      // Flattens the nested array
                .collect(Collectors.toList());
    }

    public static void main(String[] args) {
        // Constructing the complex data structure
        List<UserDetail> devUsers = Arrays.asList(
            new UserDetail("Shoki", 5678),
            new UserDetail("Mariano", 9123)
        );
        List<UserDetail> testUsers = Arrays.asList(
            new UserDetail("Sai", 2001),
            new UserDetail("Peter", 2002)
        );
        
        List<UserGroup> myDataUserList = Arrays.asList(
            new UserGroup("dev", devUsers),
            new UserGroup("test", testUsers)
        );

        List<UserDetail> output = flattenNestedList(myDataUserList);
        
        System.out.println("Input List (Simplified): [Group 'dev' containing " + devUsers.size() + " users, Group 'test' containing " + testUsers.size() + " users]");
        System.out.println("Output (Flattened List of UserDetail objects):");
        // Print output in a format close to JSON for clarity
        System.out.println("[");
        output.forEach(user -> System.out.println("  " + user + (output.indexOf(user) < output.size() - 1 ? "," : "")));
        System.out.println("]");
    }
}

OUTPUT:

[
  {"name":"Shoki","id":5678},
  {"name":"Mariano","id":9123},
  {"name":"Sai","id":2001},
  {"name":"Peter","id":2002}
]




