HMACWith:

input:

import org.apache.camel.builder.RouteBuilder;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets;

public class HmacWithRoute extends RouteBuilder {

    @Override
    public void configure() {

        from("direct:start")
            .process(exchange -> {

                byte[] key = "secret_key".getBytes(StandardCharsets.UTF_8);
                byte[] data = "Some value to hash".getBytes(StandardCharsets.UTF_8);

                Mac mac = Mac.getInstance("HmacSHA256");
                mac.init(new SecretKeySpec(key, "HmacSHA256"));

                byte[] hmacBytes = mac.doFinal(data);

                // Convert to HEX (DataWeave Crypto::HMACWith output format)
                StringBuilder hex = new StringBuilder();
                for (byte b : hmacBytes) {
                    hex.append(String.format("%02x", b));
                }

                exchange.getMessage().setBody(
                    "{ \"HMACWith\" : \"" + hex + "\" }"
                );
            });
    }
}




output:

{
  "HMACWith": "b51b4fe8c4e37304605753272b5b4321f9644a9b09cb1179d7016c25041d1747"
}



