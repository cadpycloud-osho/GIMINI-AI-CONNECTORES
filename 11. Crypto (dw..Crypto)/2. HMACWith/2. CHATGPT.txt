HMACWith:



input:
package com.example.demo.util;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class CryptoUtils {

    public static String hmacWithSHA256(String key, String message) {
        try {
            Mac sha256_HMAC = Mac.getInstance("HmacSHA256");
            SecretKeySpec secretKey =
                    new SecretKeySpec(key.getBytes(), "HmacSHA256");

            sha256_HMAC.init(secretKey);

            byte[] hash = sha256_HMAC.doFinal(message.getBytes());

            // Convert bytes to hex
            StringBuilder hexString = new StringBuilder();
            for (byte b : hash) {
                String hex = Integer.toHexString(0xff & b);
                if (hex.length() == 1) hexString.append("0");
                hexString.append(hex);
            }

            return hexString.toString();

        } catch (Exception e) {
            throw new RuntimeException("Error generating HMAC", e);
        }
    }
}

package com.example.demo.controller;

import com.example.demo.util.CryptoUtils;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.LinkedHashMap;
import java.util.Map;

@RestController
public class HmacController {

    @GetMapping("/hmac")
    public Map<String, String> generateHmac() {

        Map<String, String> result = new LinkedHashMap<>();

        String key = "secret_key";
        String message = "Some value to hash";

        result.put("HMACWith", CryptoUtils.hmacWithSHA256(key, message));

        return result;
    }
}
output:


{
  "HMACWith": "b51b4fe8c4e37304605753272b5b4321f9644a9b09cb1179d7016c25041d1747"
}

