HMACWith:



input:

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

public class Main {

    private static final String HMAC_ALGORITHM = "HmacSHA256";

    public static String calculateHmacHex(String data, String key) 
            throws NoSuchAlgorithmException, InvalidKeyException {
        
        // 1. Convert inputs to bytes (using UTF-8)
        byte[] keyBytes = key.getBytes(StandardCharsets.UTF_8);
        byte[] dataBytes = data.getBytes(StandardCharsets.UTF_8);

        // 2. Setup the key specification and MAC
        SecretKeySpec secretKeySpec = new SecretKeySpec(keyBytes, HMAC_ALGORITHM);
        Mac mac = Mac.getInstance(HMAC_ALGORITHM);
        mac.init(secretKeySpec);

        // 3. Calculate the raw binary HMAC
        byte[] hmacBytes = mac.doFinal(dataBytes);
        
        // 4. Convert the raw bytes to a lowercase hex string
        return bytesToHex(hmacBytes);
    }
    
    /**
     * Helper method to convert a byte array to a lowercase hexadecimal string.
     */
    private static String bytesToHex(byte[] bytes) {
        StringBuilder hexString = new StringBuilder(2 * bytes.length);
        for (byte b : bytes) {
            // Formats the byte as a two-character lowercase hexadecimal string
            String hex = String.format("%02x", b);
            hexString.append(hex);
        }
        return hexString.toString();
    }

    public static void main(String[] args) {
        String data = "Some value to hash";
        String key = "secret_key";

        try {
            String hmacHex = calculateHmacHex(data, key);

            System.out.println("Input Data: " + data);
            System.out.println("Input Key: " + key);
            System.out.println("Algorithm: " + HMAC_ALGORITHM);
            System.out.println("---");
            System.out.println("Java Output (Hex-encoded): {\"HMACWith\": \"" + hmacHex + "\"}");

        } catch (NoSuchAlgorithmException e) {
            System.err.println("Algorithm not found: " + e.getMessage());
        } catch (InvalidKeyException e) {
            System.err.println("Invalid key: " + e.getMessage());
        }
    }
}

output:

{ 
  "HMACWith": "b51b4fe8c4e37304605753272b5b4321f9644a9b09cb1179d7016c25041d1747" 
}
