diff:


input:



import java.util.*;

public class Main {
    
    public static void main(String[] args) {
        Map<String, Object> result = executeAllTests();
        System.out.println(prettyPrint(result));
    }
    
    @SuppressWarnings("unchecked")
    public static Map<String, Object> executeAllTests() {
        Map<String, Object> result = new HashMap<>();
        
        result.put("a", diff(map("a", 1), map("b", 1)));
        result.put("b", diff(map("ns0#a", 1), map("ns1#a", 1)));
        result.put("c", diff(Arrays.asList(1,2,3), Collections.emptyList()));
        result.put("d", diff(Collections.emptyList(), Arrays.asList(1,2,3)));
        result.put("e", diff(Arrays.asList(1,2,3), Arrays.asList(1,2,3,4)));
        result.put("f", diff(Arrays.asList(map("a", 1)), Arrays.asList(map("a", 2))));
        result.put("g", diff(map("a", 1, "c", 2), map("a", 1, "c", 3)));
        result.put("h", diff(true, false));
        result.put("i", diff(1, 2));
        result.put("j", diff("test", "other test"));
        result.put("k", diff(map("a", 1), map("a", 1)));
        result.put("l", diff(map("ns0#a", 1), map("ns0#a", 1)));
        result.put("m", diff(Arrays.asList(1,2,3), Arrays.asList(1,2,3)));
        result.put("n", diff(Collections.emptyList(), Collections.emptyList()));
        result.put("o", diff(Arrays.asList(map("a", 1)), Arrays.asList(map("a", 1))));
        result.put("p", diff(map("a", 1, "c", 2), map("a", 1, "c", 2)));
        result.put("q", diff(true, true));
        result.put("r", diff(1, 1));
        result.put("s", diff("other test", "other test"));
        result.put("t", diff(map("a", 1, "b", 2), map("b", 2, "a", 1), true));
        result.put("u", diff(
            Arrays.asList(map("format", "ssn", "data", "ABC")), 
            Arrays.asList(map("format", "ssn", "data", "ABC"))
        ));
        
        return result;
    }
    
    @SuppressWarnings("unchecked")
    public static Map<String, Object> diff(Object expected, Object actual) {
        return diff(expected, actual, false);
    }
    
    @SuppressWarnings("unchecked")
    public static Map<String, Object> diff(Object expected, Object actual, boolean unordered) {
        DiffResult result = compare(expected, actual, "/", unordered);
        
        Map<String, Object> output = new HashMap<>();
        output.put("matches", result.isMatch());
        output.put("diffs", result.getDiffs());
        return output;
    }
    
    static class DiffResult {
        private final boolean match;
        private final List<Map<String, String>> diffs;
        
        DiffResult(boolean match, List<Map<String, String>> diffs) {
            this.match = match;
            this.diffs = diffs;
        }
        
        boolean isMatch() { return match; }
        List<Map<String, String>> getDiffs() { return diffs; }
    }
    
    private static DiffResult compare(Object expected, Object actual, String path, boolean unordered) {
        List<Map<String, String>> diffs = new ArrayList<>();
        
        if (expected == null && actual == null) return new DiffResult(true, diffs);
        if (expected == null || actual == null || !expected.equals(actual)) {
            diffs.add(createDiff(expected, actual, path));
            return new DiffResult(false, diffs);
        }
        
        if (expected instanceof Map && actual instanceof Map) {
            return compareMaps((Map<?, ?>) expected, (Map<?, ?>) actual, path, unordered, diffs);
        } else if (expected instanceof List && actual instanceof List) {
            return compareLists((List<?>) expected, (List<?>) actual, path, unordered, diffs);
        }
        
        return new DiffResult(true, diffs);
    }
    
    @SuppressWarnings("unchecked")
    private static DiffResult compareMaps(Map<?, ?> expected, Map<?, ?> actual, String path, 
                                        boolean unordered, List<Map<String, String>> diffs) {
        if (expected.size() != actual.size()) {
            diffs.add(Map.of("expected", "Entry " + path + " with type Number", 
                           "actual", "was not present in object.", "path", path));
            return new DiffResult(false, new ArrayList<>(diffs));
        }
        
        for (Object key : expected.keySet()) {
            String keyStr = key.toString();
            String newPath = path + "." + keyStr;
            DiffResult subResult = compare(expected.get(key), actual.get(key), newPath, unordered);
            if (!subResult.isMatch()) {
                diffs.addAll(subResult.getDiffs());
                return new DiffResult(false, new ArrayList<>(diffs));
            }
        }
        return new DiffResult(true, diffs);
    }
    
    @SuppressWarnings("unchecked")
    private static DiffResult compareLists(List<?> expected, List<?> actual, String path, 
                                         boolean unordered, List<Map<String, String>> diffs) {
        if (expected.size() != actual.size()) {
            diffs.add(Map.of("expected", "Array size is " + actual.size(), 
                           "actual", "was " + expected.size(), "path", path));
            return new DiffResult(false, new ArrayList<>(diffs));
        }
        
        for (int i = 0; i < expected.size(); i++) {
            String newPath = path + "[" + i + "]";
            DiffResult subResult = compare(expected.get(i), actual.get(i), newPath, unordered);
            if (!subResult.isMatch()) {
                diffs.addAll(subResult.getDiffs());
                return new DiffResult(false, new ArrayList<>(diffs));
            }
        }
        return new DiffResult(true, diffs);
    }
    
    private static Map<String, String> createDiff(Object expected, Object actual, String path) {
        String expStr = formatValue(expected);
        String actStr = formatValue(actual);
        return Map.of("expected", expStr, "actual", actStr, "path", path);
    }
    
    private static String formatValue(Object value) {
        if (value == null) return "null";
        return value.toString();
    }
    
    private static Map<String, Object> map(Object... keyValues) {
        Map<String, Object> map = new HashMap<>();
        for (int i = 0; i < keyValues.length; i += 2) {
            map.put(keyValues[i].toString(), keyValues[i + 1]);
        }
        return map;
    }
    
    private static String prettyPrint(Object obj) {
        if (obj instanceof Map) {
            return prettyPrintMap((Map<?, ?>) obj, 0);
        }
        return obj.toString();
    }
    
    private static String prettyPrintMap(Map<?, ?> map, int indent) {
        StringBuilder sb = new StringBuilder();
        sb.append("{\n");
        String spaces = "  ".repeat(indent + 1);
        
        int i = 0;
        for (Map.Entry<?, ?> entry : map.entrySet()) {
            sb.append(spaces).append("\"").append(entry.getKey()).append("\" : ");
            Object value = entry.getValue();
            if (value instanceof Map) {
                sb.append(prettyPrintMap((Map<?, ?>) value, indent + 1));
            } else if (value instanceof List) {
                sb.append(prettyPrintList((List<?>) value, indent + 1));
            } else {
                sb.append("\"").append(value).append("\"");
            }
            if (++i < map.size()) sb.append(",");
            sb.append("\n");
        }
        sb.append("  ".repeat(indent)).append("}");
        return sb.toString();
    }
    
    private static String prettyPrintList(List<?> list, int indent) {
        StringBuilder sb = new StringBuilder();
        sb.append("[\n");
        String spaces = "  ".repeat(indent + 1);
        
        int i = 0;
        for (Object item : list) {
            sb.append(spaces);
            if (item instanceof Map) {
                sb.append(prettyPrintMap((Map<?, ?>) item, indent + 1));
            } else {
                sb.append("\"").append(item).append("\"");
            }
            if (++i < list.size()) sb.append(",");
            sb.append("\n");
        }
        sb.append("  ".repeat(indent)).append("]");
        return sb.toString();
    }
}


output:


{
  "a": {
    "matches": false,
    "diffs": [
      {
        "expected": "Entry (root).a with type Number",
        "actual": "was not present in object.",
        "path": "(root).a"
      }
    ]
  },
  "b": {
    "matches": false,
    "diffs": [
      {
        "expected": "Entry (root).ns0#a with type Number",
        "actual": "was not present in object.",
        "path": "(root).ns0#a"
      }
    ]
  },
  "c": {
    "matches": false,
    "diffs": [
      {
        "expected": "Array size is 0",
        "actual": "was 3",
        "path": "(root)"
      }
    ]
  },
  "d": {
    "matches": false,
    "diffs": [
      {
        "expected": "Array size is 3",
        "actual": "was 0",
        "path": "(root)"
      }
    ]
  },
  "e": {
    "matches": false,
    "diffs": [
      {
        "expected": "Array size is 4",
        "actual": "was 3",
        "path": "(root)"
      }
    ]
  },
  "f": {
    "matches": false,
    "diffs": [
      {
        "expected": "1 as String {mimeType: \"application/dw\"}",
        "actual": "2 as String {mimeType: \"application/dw\"}",
        "path": "(root)[0].a"
      }
    ]
  },
  "g": {
    "matches": false,
    "diffs": [
      {
        "expected": "3",
        "actual": "2",
        "path": "(root)"
      }
    ]
  },
  "h": {
    "matches": false,
    "diffs": [
      {
        "expected": "false",
        "actual": "true",
        "path": "(root)"
      }
    ]
  },
  "i": {
    "matches": false,
    "diffs": [
      {
        "expected": "2",
        "actual": "1",
        "path": "(root)"
      }
    ]
  },
  "j": {
    "matches": false,
    "diffs": [
      {
        "expected": "other test",
        "actual": "test",
        "path": "(root)"
      }
    ]
  },
  "k": {
    "matches": true,
    "diffs": []
  },
  "l": {
    "matches": true,
    "diffs": []
  },
  "m": {
    "matches": true,
    "diffs": []
  },
  "n": {
    "matches": true,
    "diffs": []
  },
  "o": {
    "matches": true,
    "diffs": []
  },
  "p": {
    "matches": true,
    "diffs": []
  },
  "q": {
    "matches": true,
    "diffs": []
  },
  "r": {
    "matches": true,
    "diffs": []
  },
  "s": {
    "matches": true,
    "diffs": []
  },
  "t": {
    "matches": true,
    "diffs": []
  },
  "u": {
    "matches": true,
    "diffs": []
  }
}
