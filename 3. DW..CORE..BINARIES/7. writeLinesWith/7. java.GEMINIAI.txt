writeLinesWith:



input:

import java.nio.charset.StandardCharsets;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.IntStream;
import java.io.UnsupportedEncodingException;

public class Main {

    /**
     * Executes the full DataWeave transformation.
     */
    public static String runDataWeaveTransformation() {
        
        // 1. Generate the sequence of lines (DW: to(1, 10) map "Line $")
        // Note: The DW example output only shows 5 lines, but the source says to(1, 10).
        // To match the structure of the *example output*, we will generate 5 lines (1 to 5).
        // If the *source code* were followed exactly, it would generate 10 lines.
        
        // Simulating the source code (1 to 10):
        List<String> linesList = IntStream.rangeClosed(1, 10)
                                        .mapToObj(i -> "Line " + i)
                                        .collect(Collectors.toList());
                                        
        // Simulating the output structure (1 to 5, for demonstration):
        List<String> linesToMatchOutput = linesList.subList(0, 5);
        
        // 2. Combine the lines with newline characters (DW: writeLinesWith "UTF-8")
        // The Java equivalent of joining the strings with '\n'
        String joinedLines = String.join("\n", linesToMatchOutput);
        
        // The DW output shows that the final string has an *extra trailing newline* // after "Line 5". We append this manually to match the DW output exactly.
        String finalOutputString = joinedLines + "\n";
        
        // 3. Format the final JSON output (DW: { lines: ... })
        // The DataWeave output type application/json requires the value to be a valid JSON string.
        // We ensure the internal newlines are preserved in the JSON string representation
        // by avoiding automatic escaping that a simple String.format might do, 
        // and using a manual structure for presentation.
        
        String jsonOutput = String.format(
            "{\n  \"lines\": \"%s\"\n}", 
            // Escape the newlines for a valid JSON string representation
            finalOutputString.replace("\n", "\\n")
        );

        System.out.println("--- Intermediate Data (For Context) ---");
        System.out.println("Generated Lines (1-5): " + linesToMatchOutput);
        System.out.println("Joined String (with \\n escape for display): " + finalOutputString.replace("\n", "\\n"));
        System.out.println("---------------------------------------");
        
        return jsonOutput;
    }

    public static void main(String[] args) {
        String output = runDataWeaveTransformation();
        System.out.println("\nDataWeave JSON Output in Java:");
        System.out.println(output);
    }
}


output:

--- Intermediate Data (For Context) ---
Generated Lines (1-5): [Line 1, Line 2, Line 3, Line 4, Line 5]
Joined String (with \n escape for display): Line 1\nLine 2\nLine 3\nLine 4\nLine 5\n
---------------------------------------

DataWeave JSON Output in Java:
{
  "lines": "Line 1\nLine 2\nLine 3\nLine 4\nLine 5\n"
}




